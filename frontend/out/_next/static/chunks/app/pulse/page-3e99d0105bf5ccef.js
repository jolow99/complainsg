(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[916],{1703:(e,t,a)=>{"use strict";a.d(t,{IF:()=>n,Sk:()=>l,Y$:()=>c,e2:()=>u,gb:()=>d,iU:()=>o,jj:()=>m,lV:()=>i});var s=a(8915),r=a(5317);let l=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ryan",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"123",l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};try{var n;let i=(0,r.rJ)(s.db,"threads"),o=(0,r.P)(i,(0,r._M)("userID","==",t),(0,r._M)("threadID","==",a)),c=null!=(n=await (0,r.GG)(o))?n:[],d=null;if(!c.empty&&c.docs[0].exists()){let s={updatedAt:new Date,title:l.topic,userID:t,threadID:a,category:"feedback",headId:e.message.id,tags:[],topic:l.topic,location:l.location,summary:l.summary,quality:l.quality};d=c.docs[0].ref,await (0,r.mZ)(d,s)}else{let l={userID:t,threadID:a,localId:"",title:"",createdAt:new Date,updatedAt:new Date,category:"feedback",headId:e.message.id,tags:[],topic:null,location:null,summary:null,quality:0};d=(0,r.H9)(s.db,"threads",a),await (0,r.BN)(d,l)}let u=(0,r.rJ)(s.db,"threads",d.id,"messages"),m=await (0,r.GG)(u),p={id:e.message.id,parentId:e.parentId,content:e.message.content,role:e.message.role,metadata:e.message.metadata,createdAt:e.message.createdAt};await (0,r.gS)(u,p),console.log("✅ Saved ".concat(e.message.role," message to subcollection"),{messageIndex:m.size})}catch(t){console.error("❌ Error saving ".concat(e.message.role," message to DB:"),t)}},n=async e=>{let t=(0,r.rJ)(s.db,"threads"),a=(0,r.P)(t,(0,r._M)("userID","==",e));return(await (0,r.GG)(a)).docs.map(e=>e.data())},i=async e=>{let t=(0,r.rJ)(s.db,"threads",e,"messages"),a=(0,r.P)(t);return(await (0,r.GG)(a)).docs.map(e=>e.data())},o=async e=>{let t=(0,r.H9)(s.db,"threads",e);return(await (0,r.x7)(t)).data()},c=async e=>{let t=(0,r.rJ)(s.db,"threads"),a=(0,r.P)(t,(0,r._M)("topic","==",e));return(await (0,r.GG)(a)).docs.map(e=>e.data())},d=async()=>{let e=(0,r.rJ)(s.db,"topics"),t=(0,r.P)(e),a=await (0,r.GG)(t);return console.log("\uD83D\uDD0D DATABASE FUNCTION: topicsSnapshot =",a),a.docs.map(e=>e.data())},u=async e=>{let t=(0,r.rJ)(s.db,"topics"),a=(0,r.P)(t,(0,r._M)("topic","==",e)),l=await (0,r.GG)(a);return l.empty?null:l.docs[0].data()},m=async e=>{let t=(0,r.rJ)(s.db,"threads",e,"messages"),a=(0,r.P)(t);return(await (0,r.GG)(a)).docs.map(e=>e.data())}},2255:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>g});var s=a(5155),r=a(2115),l=a(1703),n=a(8482);function i(e){let{topic:t,description:a,imageURL:r}=e;return(0,s.jsxs)(n.Zp,{className:"w-xl",children:[(0,s.jsxs)(n.aR,{className:"flex flex-col justify-around gap-6 py-6 pl-6",children:[(0,s.jsx)(n.ZB,{className:"text-3xl font-bold",children:t}),(0,s.jsx)(n.BT,{children:a})]}),(0,s.jsx)(n.X9,{className:"flex flex-col flex-shrink-0 p-6",children:(0,s.jsx)("img",{src:r||"/Bird_Cuphead.png",alt:"Pulse",width:100,height:100,className:"rounded-lg border-2 border-gray-200 shadow-sm w-full h-48 object-cover"})})]})}var o=a(5695),c=a(3864),d=a(3999);function u(e){let{className:t,...a}=e;return(0,s.jsx)(c.bL,{"data-slot":"tabs",className:(0,d.cn)("flex flex-col gap-2",t),...a})}function m(e){let{className:t,...a}=e;return(0,s.jsx)(c.B8,{"data-slot":"tabs-list",className:(0,d.cn)("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",t),...a})}function p(e){let{className:t,...a}=e;return(0,s.jsx)(c.l9,{"data-slot":"tabs-trigger",className:(0,d.cn)("data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...a})}function f(e){let{className:t,...a}=e;return(0,s.jsx)(c.UC,{"data-slot":"tabs-content",className:(0,d.cn)("flex-1 outline-none",t),...a})}function g(){let[e,t]=(0,r.useState)([]),a=(0,o.useRouter)();return(0,r.useEffect)(()=>{(0,l.gb)().then(async e=>{console.log("\uD83D\uDD0D PULSE PAGE: topics =",e);let a=[];for(let t of e){let e=await (0,l.Y$)(t.topic);console.log("\uD83D\uDD0D PULSE PAGE: threads =",e),e.length>0&&a.push({topic:t.topic,summary:t.summary,imageURL:t.imageURL})}console.log("\uD83D\uDD0D PULSE PAGE: topicsWithThreads =",a),t(a)})},[]),(0,s.jsx)("div",{className:"min-h-screen flex w-full",children:(0,s.jsxs)(u,{defaultValue:"list",className:"w-full h-full flex flex-col items-center justify-center",children:[(0,s.jsxs)(m,{className:"my-12",children:[(0,s.jsx)(p,{value:"list",children:"List"}),(0,s.jsx)(p,{value:"map",children:"Map"})]}),(0,s.jsx)(f,{value:"list",children:(0,s.jsx)("div",{className:"flex flex-col w-full items-center justify-center",children:e.map(e=>(0,s.jsx)("div",{onClick:()=>a.push("/pulse/topic?topic=".concat(e.topic)),className:"cursor-pointer hover:scale-105 transition-transform duration-200 mb-6",children:(0,s.jsx)(i,{topic:e.topic,description:e.summary,imageURL:e.imageURL})},e.topic))})}),(0,s.jsx)(f,{value:"map",children:"Work in progress"})]})})}},3999:(e,t,a)=>{"use strict";a.d(t,{cn:()=>l});var s=a(2596),r=a(9688);function l(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,r.QP)((0,s.$)(t))}},8482:(e,t,a)=>{"use strict";a.d(t,{BT:()=>o,X9:()=>c,ZB:()=>i,Zp:()=>l,aR:()=>n});var s=a(5155);a(2115);var r=a(3999);function l(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card",className:(0,r.cn)("bg-card text-card-foreground flex flex-row justify-between rounded-xl border shadow-sm",t),...a})}function n(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card-header",className:(0,r.cn)("flex flex-col gap-6",t),...a})}function i(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card-title",className:(0,r.cn)("leading-none font-semibold",t),...a})}function o(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card-description",className:(0,r.cn)("text-muted-foreground text-sm",t),...a})}function c(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card-action",className:(0,r.cn)("col-start-2 row-span-2 row-start-1 self-start justify-self-end",t),...a})}},8915:(e,t,a)=>{"use strict";a.d(t,{db:()=>i});var s=a(3915),r=a(1906),l=a(5317);let n=(0,s.Dk)().length?(0,s.Sx)():(0,s.Wp)({apiKey:"AIzaSyCx76hPfuiJY5WXVn0RBCozB-WyD_Z0gL0",authDomain:"complainsg-b0b10.firebaseapp.com",projectId:"complainsg-b0b10",storageBucket:"complainsg-b0b10.firebasestorage.app",messagingSenderId:"314044733634",appId:"1:314044733634:web:367d7154e09e6ef1ed435b",measurementId:"G-ZED4RQZEEX"});(0,r.TT)().then(e=>e?(0,r.P5)(n):null);let i=(0,l.aU)(n)},9278:(e,t,a)=>{Promise.resolve().then(a.bind(a,2255))}},e=>{e.O(0,[135,511,277,864,441,964,358],()=>e(e.s=9278)),_N_E=e.O()}]);